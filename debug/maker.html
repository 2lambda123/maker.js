<html>
<head>
    <title>Maker.js debug TypeScript source code</title>

    <link href="viewer.css" rel="stylesheet" />

    <script src="../src/core/maker.js"></script>
    <script src="../src/core/angle.js"></script>
    <script src="../src/core/point.js"></script>
    <script src="../src/core/units.js"></script>
    <script src="../src/core/measure.js"></script>
    <script src="../src/core/path.js"></script>
    <script src="../src/core/model.js"></script>
    <script src="../src/core/tools.gap.js"></script>
    <script src="../src/core/exports.js"></script>
    <script src="../src/core/dxf.js"></script>
    <script src="../src/core/svg.js"></script>
    <script src="../src/models/RoundRectangle.js"></script>
    <script src="../src/models/BoltRectangle.js"></script>
    <script src="../src/models/BoltCircle.js"></script>
    <script src="../src/models/OvalArc.js"></script>
    <script src="viewer.js"></script>

    <script>

        Viewer.SvgOrigin = [150, 400];

        var myViewParams = {
            count: 1,
            height: 3,
            width: 4,
            radius: .25,
            angle: 0
        };

        function myModelFactory(params) {

            this.paths = [];
            this.models = [];

            var circle = makerjs.Path.CreateCircle('c1', [], Math.min(params.height, params.width) / 2 - .5);

            if (params.radius < 0.5) {
                this.models.push(makerjs.Model.Move(new makerjs.Models.BoltRectangle(params.width - .4, params.height - .4, .07), [.2, .2]));
            }

            this.paths.push(makerjs.Path.MoveRelative(circle, [params.width / 2, params.height / 2]));

            this.models.push(new makerjs.Models.RoundRectangle(params.width, params.height, params.radius));

            this.models.push(makerjs.Model.Move(new makerjs.Models.BoltCircle(circle.radius + 0.25, .05, 6), [params.width / 2, params.height / 2]));

            makerjs.Model.Rotate(this, params.angle);
        }

        Viewer.Render = function (newParams) {

            //apply slider parameters
            makerjs.ExtendObject(myViewParams, newParams);

            //modeling
            var myModel = {
                models: [new myModelFactory(myViewParams)]
            };

            var m = makerjs.Measure.ModelExtents(myModel.models[0]);
            var x = m.high.x - m.low.x + .025;

            for (var i = 1; i < myViewParams.count; i++) {
                myModel.models.push(makerjs.Model.Move(new myModelFactory(myViewParams), [x * i, 0]));
            }

            //svg output
            var annotate = document.getElementById('checkAnnotate').checked;
            var svg = makerjs.exports.SVG(myModel, { origin: Viewer.SvgOrigin, scale: Viewer.ViewScale, annotate: annotate });
            document.getElementById("svg-zone").innerHTML = svg;

            return myModel;
        }


    </script>

</head>
<body>

    <div class="panel">
        count: <input type="range" min="1" max="10" step="1" value="1" onchange="Viewer.Render({ count: this.valueAsNumber })" />
        height: <input type="range" min="1" max="7" step=".1" value="3" onchange="Viewer.Render({ height: this.valueAsNumber })" />
        width: <input type="range" min="1" max="7" step=".1" value="4" onchange="Viewer.Render({ width: this.valueAsNumber })" />
        radius: <input type="range" min="0" max="2" step=".1" value=".25" onchange="Viewer.Render({ radius: this.valueAsNumber })" />
        angle: <input type="range" min="-90" max="90" step="2.5" value="0" onchange="Viewer.Render({ angle: this.valueAsNumber })" />
    </div>

    <div id="view">
        <div id="svg-zone"></div>
        <div id="export-zone"></div>
    </div>

    <div class="bottompanel">
        <a href="#" onmouseover="Viewer.showExport('dxf')" onmouseout="Viewer.hideExport()" onclick="this.href = Viewer.getExport('dxf');" title="Download works in Chrome and Firefox" download="myModel.dxf">download dxf</a>
        <a href="#" onmouseover="Viewer.showExport('svg')" onmouseout="Viewer.hideExport()" onclick="this.href = Viewer.getExport('svg');" title="Download works in Chrome and Firefox" download="myModel.svg">download svg</a>
        <a href="#" onmouseover="Viewer.showExport('json')" onmouseout="Viewer.hideExport()" onclick="this.href = Viewer.getExport('json');" title="Download works in Chrome and Firefox" download="myModel.json">download json</a>
        <label for="checkAnnotate"> annotate:</label> <input id="checkAnnotate" type="checkbox" onclick="Viewer.Render()" />
        <div class="logo">Maker.js</div>
    </div>

</body>

</html>
